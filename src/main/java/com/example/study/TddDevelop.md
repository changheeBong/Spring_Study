
TDD란?
Test-Driven Development(TDD)는 테스트 주도 개발 이라는 뜻을 가지고 있다.
테스트 주도 개발은 아주 짧은 개발 사이클의 반복에 의존하는 소프트웨어 개발 프로세스이며 개발자는 새로운 기능을 추가 할 때 우선 해당 기능의 요구사항에 근거해
테스트 코드를 작성한다. 그리고 이 테스트를 통과하는 가장 간단한 코드를 작성하고 해당 코드를 리펙토링해 나가며 기능을 구현해 나간다. 코드를 작성하기 전에
테스트를 작성함으로써 개발자는 개발 프로세스 초기에 결함을 발견할 수 있고 유지 관리 가능한 코드를 작성할 수 있으며 개발 프로세스에 관련된 모든사람이 요구사항을 명확하게 이해하도록 할 수 있따.
테스트 주도 개발에서 완벽한 테스트 코드를 작성하기 위해서는 개발자가 해당 기능의 요구사항과 명세에 대해 정확히 알고 있어야 한다.

TDD의 장점과 단점
장점
1. 코드 품질 향상
TDD는 코드를 철저히 테스트하고 오류 및 버그를 확인한다. 반복적인 테스트가 더 쉬워지므로 개발자는 간단하고 유지 관리가능한 코드를 작성할 수 있게 된다. 결과적으로 유지 관리와 확장이 용이한
고품질의 코드를 생산할 수 있게 된다.
2. 빠른 개발
TDD를 처음 하는 경우에는 기존 개발보다 느려보일 수 있다. 하지만 장기적으로 보면 개발 속도를 높이게 되는데 테스트를 먼저 작성함으로써 개발자는 코드를 고도화 함과 동시에 테스트를
실행함으로써 오류를 조기에 잡아낼 수 있다. 따라서 코드에 오류가 있따면 초기에 수정 작업을 할 수 있다.
3. 협업에 용이
TDD로 개발을 할 경우 개발 단계에서도 요구사항에 대한 테스트 코드가 존재하므로 개발에 참여한 모든 구성원이 해당 코드에 대해 더 잘 이해할 수 있다.

단점
1. 초기 투자 시간
TDD는 코드를 작성하기 전에 테스트를 작성하기 위한 초기 투자 시간이 필요하다. 생각 난 아이디어를 바로 적용해가며 개발을 하고 싶은 개발자에게는 이 부분이 단점으로 적용될 수 있다.
2. 테스트 코드를 작성하기 어려울 수 있음
특정 요구사항의 경우 테스트 코드를 작성하기 어려울 수 있따. 개인적으로 프로젝트를 진행하면서 JWT에 대해 테스트 코드를 작성하는 것이 매우 어려웠는데 이 경우 내가 작성한 테스트 코드가
요구사항을 모두 커버하는지에 대해 확신이 없어지게 된다.

-------------------------------------------------------------------------------------------------------------------------------------------------------------
프로덕션 코드 VS 테스트 코드
- 프로덕션 코드 : 프로그램 구현 담당, 사용자가 실제로 사용하는 코드
- 테스트 코드 : 프로덕션 코드가 제대로 작동하는지 테스트하는 코드

TDD = TFD(Test First Development) + 리팩토링
테스트를 먼저 작성하고, 리팩토링하는 방법이다.
단순히 순서가 먼저일까? 아직 이 방법을 사용해보지 않아서 어떻게 감을 잡아야 할지 좀 어렵게 느껴졌다.

TDD의 과정
코치가 예를 들어준 방법을 통해서 조금 감을 잡을수 있었다.
1. 실패하는 테스트 코드를 작성한다. 이때 컴파일 에러도 실패다.
2. 컴파일 에러부터, 테스트 코드의 통과까지 빠르게 성공하는 프로덕션 코드를 작성한다.

조금 독특했다고 느껴졌던 점은, 굉장히 이 과정이 답답하게 느껴졌던 것이다.

예를 들어서, 로또에서 사용될 숫자를 생성하는 클래스를 TDD 방식으로 작성한다고 생각해보자.
로또에서 발생할 수 있는 숫자는 1에서 45이다. 따라서 이외의 값은 예외 처리한다.
사람이고 뇌가 달려있따면 처음부터 0이하 46이상 숫자를 예외 처리하는 코드를 작성하는게 어렵지 않을 것이다.
하지만 코치는 0과 46의 경우만 예외 처리 하고 있는 코드를 작성했다. 속 터졌다.

현재는 우리가 익숙한 도메인을 하고 있지만, 익숙하지 않아서 구체적 구현이 완벽하게 떠오르지 않을 때에 사용할 수 있는 방법이다.
TDD Cycle ->  TEST FAILES -> TEST PASSES -> REFACTOR -> TESTFAILES
TDD란 프로그래밍 의사 결정과 피드백 사이의 간극을 의식하고 제어하는 기술이다.

3. 프로덕션 코드를 리팩터링한다.
TDD 방식은 끈임없이 실패하는 코드를 작성하고, 최소한의 프로덕션 코드로 성공하게 하고, 그 뒤에 코드를 리팩터링하는 방식이다.
리팩터링하다가 실패하면 어떻게 해 라는 의문이 들었지만, 리팩터링은 테스트 코드의 결과에 영향을 미치지 말아야 한다.
리팩터링은 동일한 기능 내에서 코드 퀄리티가 높아지는 것이므로, 만약에 리팩터링으로 인해 기능 자체에 변화가 있어서 성공하던 코드가 실패했다면
나의 리팩터링이 잘못된 것이 아닌지 의심해볼 필요가 있다.

TDD를 하는 이유는 ...? 단위테스트 작성이랑 똑같은 거 아냐? 특별한 장점이 있어?
TDD와 단위 테스트를 작성한다의 가장 큰 차이는 테스트 코드의 작성 시점에 있다.
TDD는 테스트 코드부터, 단위 테스트는 프로덕션 코드부터 작성한다는 데에 큰 차이가 있다.

TDD를 했을 때에 더 좋은 점은 그래서 무엇일까?
현재 내가 내린 답변은, 실질적이고 회피하지 않는 테스트를 할 수 있다는 것이다.

단위 테스트를 작성하다보면 프로덕션 코드를 작성하는 동시에 테스트하기 때문에 단위 테스트에 대해 잊을 때가 정말 많다.
따라서 의식적으로 단위 테스트를 작성해야 한다.

하지만 단위 테스트를 작성하다 보면, 동시에 '아, 다음 기능도 구현해야 하는데 지금 테스트코드를 쓰고 있어야 하나?' 라던가,
'이 부분은 너무 테스트하기 어려운 것 같은데 그냥 슬쩍 넘어갈까?' 하는 충동이 들 때가 정말 많다.
실제로도 로직의 정말 메인이 되는 부분을 테스트 하는 경우도 있지만, 부수적인 부분만을 꼼꼼히 테스트 하는 경우도 많았다.
코드를 작성하면서 뇌에 여러 가지 다음 todo에 대한 부하가 걸리는 경우가 많다는 의미이다. 이런 점에서 생각해보면, TDD는 1단계에서는 단위테스트만을,
2단계에서는 프로덕션 코드만을 그 후에는 리팩터링만을 . 이렇게 한 번에 한 가지만을 새악ㄱ하기 때문에 뇌에 부하가 적고 따라서 더 의식적으로 모든 코드를 통제하는 느낌이 드는 것 같다.
결과적으로 단위 테스트를 작성하는 방식은, 커버리지만 높고 사실 중요한 부분을 테스트하지 못하는 경우가 발생한다.
작성된 프로덕션에 대한 테스트를 의무적으로 추가하는 느낌이 들 때도 많다.
이런 점에서 TDD방식은 좀 더 진정성 있게 프로그램의 동작을 테스트하는 방법인 것 같기도 하다.

TDD를 할지 결정하는 기준
그렇다면 TDD가 이렇게 좋으니 만능일까?
프로그래밍에 만능, 절대적 규칙은 없다. 내가 코드를 작성해 보면서 어떤 경우에 TDD가 유용했는지, 어떤 경우에는 프로덕션 코드부터 작성하는 것보다 못한 결과가 나왔는지 경험적으로 생각하면서
나만의 기준을 세우는 것이 좋다.
첫째, 프로그램의 input, output이 명확할 때
둘째, 프로그램에 대한 이해도가 부족해 구현 코드에 대한 상상이 되지 않을 때
셋째, 머릿속에 그려지더라도, 비즈니스의 핵심이라 문제가 터지면 큰 문제가 되는 중요도 높은 부분의 코드를 작성할 때

제한된 시간, 자원 안에서 얼만큼 할 것인지는 개발자의 선택이다. 따라서 나만의 기준을 만들어야 한다는 것이 또 결론이다.

TDD 원칙
TDD는 보통의 프로그래머가 처음 사용하는 방식과 정 반대의 순서를 가지기 때문에 의식적으로 하지 않으면 나도 모르게 프로덕션 코드에 먼저 손을 대고 있기 쉽다. 페어가 제어해주는 것이 편한 것 같다.

누군가의 페어가 된다면, TDD 차단기가 되어주자!

